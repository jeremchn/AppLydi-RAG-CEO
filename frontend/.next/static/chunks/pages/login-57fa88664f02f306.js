(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{6429:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return n(7644)}])},7644:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return Login}});var r=n(5893),o=n(7294),t=n(1163),a=n(7066),l=n(6501),c=n(9283),i=n(7349),d=n(3454);let u=d.env.NEXT_PUBLIC_API_URL?d.env.NEXT_PUBLIC_API_URL:window.location.hostname.includes("run.app")?window.location.origin.replace("frontend","backend"):"http://localhost:8080";function Login(){let[e,s]=(0,o.useState)(!0),[n,m]=(0,o.useState)({username:"",email:"",password:""}),[x,p]=(0,o.useState)(!1),h=(0,t.useRouter)(),handleSubmit=async r=>{r.preventDefault(),p(!0),console.log("API_URL:",u),console.log("Environment variables:",d.env);try{let r=e?"/login":"/register",o=e?{username:n.username,password:n.password}:n;console.log("Making request to:","".concat(u).concat(r)),console.log("Payload:",o);let t=await a.Z.post("".concat(u).concat(r),o);e?(localStorage.setItem("token",t.data.access_token),l.ZP.success("Connexion r\xe9ussie !"),h.push("/")):(l.ZP.success("Inscription r\xe9ussie ! Vous pouvez maintenant vous connecter."),s(!0))}catch(s){console.error("Full error object:",s),console.error("Error response:",s.response),console.error("Error message:",s.message);let e="Une erreur s'est produite";if(s.response){var o,t;e=(null===(t=s.response)||void 0===t?void 0:null===(o=t.data)||void 0===o?void 0:o.detail)||"Erreur ".concat(s.response.status,": ").concat(s.response.statusText)}else e=s.request?"Impossible de contacter le serveur":s.message;console.error("Final error message:",e),l.ZP.error(e)}finally{p(!1)}},handleChange=e=>{m({...n,[e.target.name]:e.target.value})};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,r.jsx)(l.x7,{position:"top-right"}),(0,r.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,r.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:e?"Connexion":"Inscription"}),(0,r.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"AppLydi Assistant"})]}),(0,r.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,r.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,r.jsxs)("form",{className:"space-y-6",onSubmit:handleSubmit,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Nom d'utilisateur"}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("input",{id:"username",name:"username",type:"text",required:!0,value:n.username,onChange:handleChange,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),!e&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("input",{id:"email",name:"email",type:"email",required:!0,value:n.email,onChange:handleChange,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Mot de passe"}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("input",{id:"password",name:"password",type:"password",required:!0,value:n.password,onChange:handleChange,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:x?(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,r.jsxs)(r.Fragment,{children:[e?(0,r.jsx)(c.Z,{className:"w-5 h-5 mr-2"}):(0,r.jsx)(i.Z,{className:"w-5 h-5 mr-2"}),e?"Se connecter":"S'inscrire"]})})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>s(!e),className:"text-blue-600 hover:text-blue-500 text-sm",children:e?"Pas encore de compte ? S'inscrire":"D\xe9j\xe0 un compte ? Se connecter"})})]})})})]})}}},function(e){e.O(0,[285,774,888,179],function(){return e(e.s=6429)}),_N_E=e.O()}]);